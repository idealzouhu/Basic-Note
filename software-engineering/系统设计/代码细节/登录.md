

## 扩充登录方式

登录时，用户可以选择使用手机号、邮箱以及用户名三种组合方式登录。

假设用户表以用户名作为分片键，我们登录的时候如果没有带有用户名，使得系统无法直接锁定用户的数据位于哪个数据库或者哪张表中。为了找到用户的数据，只能对全部的数据库和表进行扫描查询，这就造成了所谓的**“读请求扩散”**问题。



为了解决这个问题，我们引入了两张**路由表**：用户手机号表和用户邮箱表。这些表的核心字段是手机号和邮箱，以及它们对应的用户名。通过这样的设计，我们能够在用户登录时，灵活地使用手机号、邮箱或用户名来进行认证。

[手摸手之从注册用户接口开始 (yuque.com)](https://www.yuque.com/magestack/12306/bhzetv04b8ydt1kg#jCCPS)