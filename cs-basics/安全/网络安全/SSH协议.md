## 一、SSH 协议概述

### 1.1 什么是 SSH 协议

SSH（Secure Shell）是一种用于<font color="red">**安全远程登录和安全文件传输**</font>的网络协议。它主要用于在不安全的网络中对网络服务进行**加密的传输**，以保护通信的安全性。

![SSH常用场景](images/download)





### 1.2 SSH 协议实现功能

SSH协议实现的主要功能包括：

1. **远程登录（Remote Login）**：SSH协议允许用户通过加密的方式在远程主机上登录并执行命令，替代了不安全的 telnet 协议。通过SSH登录，用户的登录信息、密码等敏感信息都是加密传输的，大大提高了登录的安全性。
2. **安全文件传输（Secure File Transfer）**：SSH协议还支持安全的文件传输，通常使用SSH的子协议SCP（Secure Copy Protocol）或者SFTP（SSH File Transfer Protocol）来实现。用户可以通过SCP或者SFTP协议将文件从本地系统传输到远程主机，或者从远程主机传输到本地系统，而且传输过程中所有数据都是加密的。
3. **端口转发（Port Forwarding）**：SSH还支持端口转发功能，用户可以通过SSH隧道将本地端口和远程主机的端口进行关联，从而实现安全的端口转发和数据通信。简单来说，将TCP 端口的网络数据，转发到指定的主机某个端口上。
4. **密钥认证（Public Key Authentication）**：除了使用密码认证外，SSH还支持密钥认证。用户可以生成一对公钥和私钥，并将公钥上传到远程主机，这样用户可以通过私钥进行认证，而无需输入密码。







## 二、远程登录

### 2.1 口令登录

在口令登录中**，用户需要在登录时输入用户名和密码**。当用户尝试连接到远程主机时，SSH服务器会要求用户输入密码，然后验证输入的密码是否与服务器上存储的密码匹配。如果匹配成功，则用户被授予访问权限。

**工作流程**：

1. 用户向远程主机发起连接请求。
2. SSH服务器要求用户提供用户名和密码。
3. 用户输入用户名和密码，并发送给SSH服务器。
4. SSH服务器验证密码的有效性，如果密码匹配成功，则授予用户访问权限。



### 2.2 公钥免密登录

在免密登录(Public Key Authentication)中，**用户使用密钥对进行身份验证，而不需要输入密码**。用户在本地生成一对密钥（公钥和私钥），将公钥传输到远程主机上，然后在连接时，客户端使用私钥进行签名，并将签名发送给服务器。服务器使用存储的公钥来验证签名的有效性，从而确认用户的身份。

**工作流程**：

1. 用户在本地生成一对密钥（公钥和私钥）。
2. 用户将公钥传输到远程主机上，通常是通过SSH复制命令（ssh-copy-id）或手动复制粘贴。
3. 用户连接到远程主机时，客户端会使用私钥对身份进行签名，并将签名发送给服务器。
4. 服务器使用存储的公钥来验证签名的有效性，如果签名验证成功，则授予用户访问权限，允许登录。





## 参考资料

[什么是SSH？SSH是如何工作的？ - 华为](https://info.support.huawei.com/info-finder/encyclopedia/zh/SSH.html)

[OpenSSH核心操作 | GitHub SSH连接_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1Sx4y1y7B2/?spm_id_from=333.880.my_history.page.click&vd_source=52cd9a9deff2e511c87ff028e3bb01d2)

[【科普】SSH都不懂，还搞什么网络 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/323322650)  （提供了远程登录的实际案例）

[ssh登录原理解析_ssh登录是什么意思-CSDN博客 ](https://blog.csdn.net/weixin_42616506/article/details/97262632)  （给出了 SSH 口令登录和公钥免密登录的时序图）