### I/O 多路复用

就绪查询系统调用允许一个程序同时监听多个文件描述符，检测哪些文件描述符可以执行 I/O 操作（如读、写、异常处理），从而避免为每个文件描述符都创建独立的线程或进程。

多路复用模型的典型系统调用都有其优缺点：

- **`select`**：通过一组文件描述符进行监控，但受限于文件描述符的最大数量，效率较低
- **`poll`**：没有文件描述符数量的限制，监控效率也比 `select` 更高。
- **`epoll`**（Linux 特有）：适合高并发场景，性能更好，因为它使用了事件通知机制，而不是轮询所有描述符。





### select/poll

select 适用线性结构存储进程关注的 socket 集合。

每次都要遍历文件描述符集合。

select 支持的文件描述符个数存在限制。





select 实现多路复用的方式是，将已连接的 Socket 都放到一个**文件描述符集合**，然后调用 select 函数将文件描述符集合**拷贝**到内核里，让内核来检査是否有网络事件产生，检查的方式很粗暴，就是通过**遍历**文件描述符集合的方式，当检查到有事件产生后，将此 Socket 标记为可读或可写， 接着再把整个文件描述符集合**拷贝**回用户态里，然后用户态还需要再通过**遍历**的方法找到可读或可写的 Socket，然后再对其处理。



### epoll

- epoll 在内核里使用**红黑树来跟踪进程所有待检测的文件描述符**
- epoll 使用**事件驱动**的机制，内核里**维护了一个链表来记录就绪事件**，当某个 socket 有事件发生时，通过**回调函数**内核会将其加入到这个就绪事件列表中





### 参考资料

[I/O 多路复用：select/poll/epoll | 小林coding (xiaolincoding.com)](https://xiaolincoding.com/os/8_network_system/selete_poll_epoll.html#epoll)