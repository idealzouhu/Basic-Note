## 一、背包问题

### 1.1 背包问题类型

- **0/1 背包问题**：每个物品只能选择一次，使用背包问题。
- **完全背包问题**：每个物品可以选择多次。
- **多重背包问题**：每个物品有数量限制，可以选择一定数量。
- **分数背包问题**：物品可以分割选择，使用贪心算法。
- **背包与权重限制问题**：背包问题中有多个约束条件。
- **二维背包问题**：背包有多个维度的限制。





## 二、0-1背包问题

### 2.1 问题定义

**问题：**有一个背包的容积为$W$，有$N$个物品，每个物品的价值为$v_i$，容量为$w_i$，**每个物品只能取1次**放入背包中，背包所有物品权重和最大是多少？

**问题形式化描述：**

$n$个不同容量的物品 背包容量 $W$ 

物品有着不同的 $v_i$, $w_i$

最大化： $\sum_{i=1}^n v_i x_i$

限制条件： $\sum_{i=1}^n w_i x_i \leq W，  x_i = 1 \ or \ 0 , \quad i = 1, \dots , n$



### 2.3  动态规划分析

> 递推式，初始值，

**问题描述（选择状态）：**

设**$V[i,j]$**为 前$i$个物品放到背包容量为$j$的背包中时最优解的物品总价值。则目标是：$V[n,W]$。



**递推式分析：**

(1)对于$n$个物品 ， 要得到 $V[n,W]$,  有两种情况：

- 第$n$个物品不在背包中，则最优解物品总价值为$V[n-1,W]$

- 第$n$个物品在背包中，则最优解物品总价值为前$n-1$个物品的最优解总价值$V[n-1,W-v_n]$与第$n$个物品价值的和，或者就是前$n-1$个物品的最优解总价值. 即
  $$
  V[n,W]=Max\{V[n-1,W-V_n]+v_n,V[n-1,W]\}
  $$

> 注意：
>
> 第$n$个物品不在背包中  可以理解成   第$n$个物品放不下
>
> 在第n个物品在背包中， 即背包可以放下 物品n 时， 还要考虑需不需要装 第n个物品 
>
> 着重理解 “放得下” 和 “要不要装”

(2)一般情况下分析， 要得到$V[i,j]$,  有两种情况：

- 第$i$个物品不在背包中，则最优解物品总价值为$V[i-1,j]$

- 第$i$个物品在背包中，则最优解物品总价值为前$i-1$个物品的最优解总价值$V[i-1,W-v_i]$与第$i$个物品价值的和，或者就是前$ i-1$个物品的最优解总价值. 即
  $$
  V[i,j]=Max\{V[i-1,j-w_i]+v_i,V[i-1,j]\}
  $$



**初始条件：**

$V[0,j] = 0, j \geq 0$     没有物品

$V[i,0] = 0, i \geq 0$   背包容量为0



**递推式：**

$V[i,j]=Max\{V[i-1,j-w_i]+v_i,V[i-1,j]\}$

$V[0,j] = 0, j \geq 0$

$V[i,0] = 0, i \geq 0$



**结果分析：**

> 主要包含 动态规划表， 结论推理

（1）实际背包问题

举个例子

承重量 $W = 5$

| 物品编号 | 物品质量 | 物品价值 |
| :------: | :------: | :------: |
|    1     |    2     |    12    |
|    2     |    1     |    10    |
|    3     |    3     |    20    |
|    4     |    2     |    15    |

结果是求 V[4, 5]



（2）动态规划表

| 物品编号\背包容量 | 0    | 1    | 2    | 3    | 4    | 5    |
| ----------------- | ---- | ---- | ---- | ---- | ---- | ---- |
| 0                 | 0    | 0    | 0    | 0    | 0    | 0    |
| 1                 | 0    | 0    | 12   | 12   | 12   | 12   |
| 2                 | 0    | 10   | 12   | 22   | 22   | 22   |
| 3                 | 0    | 10   | 12   |      |      |      |
| 4                 | 0    | 10   | 15   |      |      |      |



（3）结论推理

> 即**背包问题回溯**， 具体为：在使得背包内总价值最大的情况下，背包内装了哪些问题

回溯方式：

（1）**$V[i,j]=V[i-1,j]$** , 则说明没有装 第 i 个商品 ， 回溯到 $V[i-1,j]$

（2）**$V[i,j] \neq V[i-1,j]$**，则说明装了 第 i 个商品， 回溯到 $V[i-1,j-w_i]$

（3） 重复前二步，直到 $i=0$



## 三、完全背包问题

### 2.1 问题定义

**完全背包** ：有一个背包的容积为V，有N个物品，每个物品的体积为v[i]，权重为w[i]，**每个物品可以取无限次**放入背包中，背包所有物品权重和最大是多少？

> 01背包问题和完全背包问题的区别就在于，每个物品取的最大次数是1次还是无限次



### 2.2 动态规划分析

> [(19条消息) 算法之动态规划（DP）求解完全背包问题_PRML_MAN的博客-CSDN博客_完全背包问题的适用求解算法,](https://blog.csdn.net/PRML_MAN/article/details/114433408)

**问题描述（选择状态）：**

设**$V[i,j]$**为 前$i$个物品放到背包容量为$j$的背包中时最优解的物品总价值。则目标是：$V[n,W]$。



**状态转移方程分析：**

01背包问题每次增加第i物品时，因为只能取一次，从j中减去v[i]，再加上w[i]，这个操作只进行了一次。现在可以增加无数次，大家想想，怎么做呢？

$i$个物品可以增加0次（即$V[i-1][j]$），增加1次（即），增加2次，增加3次…增加k-1次，（这里$k*v[i] > j$），然后求所有值的最大值作为$V[i][j]$的值。

则状态转移方程可以设置为
$$
V[i][j] = max(V[i-1, j- k * v_i] + k * w_i，V[i-1,j])\\ (k= 0, 1, 2, 3, 4,...)
$$



**状态转移方程简化（重要）：**

0-1背包：
$$
\color{red}V[i,j] = max(V[i-1,j],  V[i-1,j - v_i] + w_i)
$$
完全背包：
$$
\color{red}V[i,j] = max(V[i-1,j],  V[i \quad\quad,j - v_i] + w_i)
$$

> 区别在于下标 从  i-1 变成 1



**完全背包状态转移方程简化原因：**

$V[i,j - v_i$ 已经将除去1个物品 $i$ 时的所有最优解已经求出来了，因此在计算$f[i,j]$时，无需再重复计算$k=2,3,4,5…$时的值了。



