## 一、全文搜索概述

### 1.1 什么是全文搜索

全文搜索是针对文本字段的一种高级搜索方法，<font color="blue">**专门用于查找大段文字中是否包含某些关键字或短语**</font>。与简单的 `LIKE` 模糊匹配不同，全文搜索具有以下特点：

- **使用全文索引**：全文搜索会为指定字段创建一种特殊的索引（`FULLTEXT`），加速搜索操作。
- **分词**：全文搜索会将长文本切分成若干“词”（Token），并按词匹配，而不是单纯字符匹配。
- **评分**：全文搜索会根据匹配的相关性给搜索结果打分，以便按相关性排序。





### 1.2 全文搜索与普通搜索的区别

| 特性           | 普通搜索 (`LIKE`)          | 全文搜索 (`FULLTEXT`)                  |
| -------------- | -------------------------- | -------------------------------------- |
| **匹配方式**   | 按字符匹配（效率较低）     | 按词匹配（效率较高）                   |
| **索引支持**   | 可以使用普通索引或全表扫描 | 使用全文索引                           |
| **适合场景**   | 小规模数据或简单部分匹配   | 大规模文本数据的复杂全文搜索           |
| **功能支持**   | 不支持相关性排序           | 支持相关性排序、布尔搜索、扩展搜索模式 |
| **多字段支持** | 需要手动构造条件           | 可直接搜索多个字段                     |
| **分词支持**   | 不支持，按字符匹配         | 支持分词，按词匹配                     |
| **性能**       | 数据量大时性能较低         | 性能较高，适合海量文本数据             |
| **使用场景**   | 精确匹配或简单模糊查询     | 文章、评论、商品描述等复杂文本搜索     |



## 二、全文搜索的全过程

### 2.1 分词原理

分词算法根据语言特点有着不同的实现方式，常见的处理有：

- **统一格式**：将文本转换为统一的格式，例如小写字母处理、去除标点符号。
- **去除停用词**：删除常见的、不重要的词汇（如 "and"、"the"、"is" 等）。
- **归一化处理**：处理英文的词干（stemming），将单词的不同形态统一，例如 `running` -> `run`。

分词后，将词条与所在文档的位置信息存储到全文索引中。索引示例：

```
"MySQL is powerful and scalable."
=> 索引内容：
   - "mysql" -> [文档1, 位置信息]
   - "powerful" -> [文档1, 位置信息]
   - "scalable" -> [文档1, 位置信息]
```

值得注意的是，在搜索过程中，用户输入的搜索关键字也会进行分词。





### 2.2 使用案例

**(1) 创建全文索引**

假设有一张 `articles` 表，存储文章的标题和内容：

```sql
CREATE TABLE articles (
    id INT PRIMARY KEY,
    title VARCHAR(255),
    content TEXT,
    FULLTEXT (title, content) -- 创建全文索引
);
```

创建 `FULLTEXT` 索引后，MySQL 会为 `title` 和 `content` 字段生成专用索引，记录哪些词出现在哪些位置。

**(2) 执行搜索**

使用 `MATCH ... AGAINST` 语法来查询。其中,

- `MATCH`:  指定要进行全文搜索的字段列表
-  `AGAINST`: 指定搜索的关键字或表达式。

例如，搜索包含 `database` 的文章：

```sql
SELECT * FROM articles
WHERE MATCH(title, content) AGAINST('database');
```

在指定的字段 `title` 和 `content` 中 ， MySQL 会根据索引找到所有包含 `database` 的文章，并按匹配度排序。



## 参考资料

[两万字详解如何使用MySQL的全文本搜索功能进行高级的数据查询和选择_mysql 全文检索-CSDN博客](https://blog.csdn.net/zy_dreamer/article/details/132417122)