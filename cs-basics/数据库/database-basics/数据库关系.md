## 一对一关系

**一对一关系**（One-to-One Relationship）是一种数据库中的关联关系，表示一个表中的一条记录只与另一个表中的一条记录相关联。即，每一条记录在两个表中只会有一个对应的记录。

假设我们有 **用户表（users）** 和 **身份证表（id_cards）**，每个用户只有一个身份证，且每个身份证只能属于一个用户。

> 主表通常是 **包含主要信息的表**,  副表通常是 **与主表相关的附加信息**.
>
> 如果有一个**用户表**和**用户的身份证表**，那么**身份证表**是副表，因为身份证只是附加信息，而不是用户的核心信息。

```
+----+----------+     +----+----------+--------------+
| id | name     |     | id | user_id  | card_number  |
+----+----------+     +----+----------+--------------+
| 1  | Alice    |     | 1  | 1        | 1234567890   |
| 2  | Bob      |     | 2  | 2        | 9876543210   |
+----+----------+     +----+----------+--------------+
```

这个例子中，`users` 表与 `id_cards` 表是 **一对一关系**，因为每个用户（`user_id`）都只对应一张身份证（`card_number`），并且每张身份证也只属于一个用户。



### 实现方式

实现方式有：

- **外键放在副表中**：将外键放在副表, 外键添加唯一性约束。例如，`id_cards` 中放外键 `user_id`，同样保证一对一关系。
- **一对一关系的两张表都用主键**：创建一个新的关联表来实现一对一关系，这样可以避免在某一张表中存在多个外键的情况。一般用于分布式数据库中或者为了更好的规范化设计。





### sql 语句

```sql
-- 用户表
CREATE TABLE users (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(50)
);

-- 身份证表
CREATE TABLE id_cards (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT UNIQUE,
    card_number VARCHAR(20),
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);
```



## 一对多关系

### 一对多关系

**一对多关系**是一种常见的数据库表关系，表示一个表中的一条记录可以关联另一个表中的多条记录。通常用 **主键和外键** 的关系来实现。

假设我们有 **用户表（users）** 和 **订单表（orders）**，用户与订单是一对多关系：

- **一个用户** 可以有 **多个订单**。
- **一个订单** 必须对应 **一个用户**。

```
users					orders
+----+----------+     +----+---------+----------+
| id | name     |     | id | user_id | amount   |
+----+----------+     +----+---------+----------+
| 1  | Alice    |     | 1  | 1       | 100.50   |
| 2  | Bob      |     | 2  | 1       | 200.00   |
|    |          |     | 3  | 2       | 50.75    |
+----+----------+     +----+---------+----------+
```

其中，`id` 为用户表的主键， `user_id` 为 orders 的外键。





## 多对多关系

### 什么是多对多关系

假设有两张表：

- **学生表（students）：** 存储学生的信息。
- **课程表（courses）：** 存储课程的信息。

一个学生可以选修多门课程，同时一门课程也可以被多个学生选修。这就形成了多对多关系。

在数据库中，多对多关系通常通过 **中间表（桥接表）** 来实现。这是关系数据库的常见模式，因为关系型数据库本身不直接支持多对多关系。



### 中间表的作用

为了解决多对多关系问题，我们需要一个 **中间表** 来将两张表关联起来。

```
students                courses                    student_courses (中间表)
+----+----------+       +----+---------+          +-----------+----------+
| id | name     |       | id | name    |          | student_id| course_id|
+----+----------+       +----+---------+          +-----------+----------+
| 1  | Alice    |       | 1  | Math    |          | 1         | 1        |
| 2  | Bob      |       | 2  | English |          | 1         | 2        |
| 3  | Charlie  |       | 3  | Physics |          | 2         | 3        |
+----+----------+       +----+---------+          +-----------+----------+
```

- `student_courses` 是中间表，用来存储学生和课程之间的关联。
- 中间表通常只包含 **外键列**，即存储两张表的主键作为外键，保持数据的规范化：
  - `student_id`：指向 `students` 表的主键。
  - `course_id`：指向 `courses` 表的主键。