## 一、一致性概述

### 1.1 什么是一致性

我们要根据对象来判别一致性到底是什么。通常而言，我们所认识的一致性主要包括以下两类：

- 事务一致性：事务在执行前后，数据库必须从一个一致状态转换到另一个一致状态。
- 数据一致性：多个副本或节点之间的数据保持一致的特性。具体来说，当多个副本中的数据被同时更新时，它们应该达到相同的状态，以确保系统的正确性。





### 1.2 数据一致性模型

一致性模型就是指，<font color="blue">在并发编程中，系统和开发者之间的一种约定，如果开发者遵循某些规则，那么开发者执行读操作或写操作的**结果是可预测的**。</font>一致性模型本质上定义了写操作的顺序和可见性，即并发写操作执行的顺序是怎样的，写操作的结果何时能够被别的进程看见。





## 二、  Jepsen 的数据一致性模型

分布式一致性验证框架  Jepsen 对一致性模型的分类如下：

![image-20240622204041510](images/image-20240622204041510.png)

一致性模型根据可用性可以分为三类，白底矩形中的模型的可用性为不可用(Unavailable)，灰底矩形中的模型的可用性为基本可用(Sticky Available)，椭圆中的模型的可用性为高可用(TotalAvailable)。具体来说:

- **Unavailable** 表示,满足这类一致性模型的系统发生网络分区时，为了保证数据一致性和正确性，系统会不可用。用CAP定理来解释，就是典型的CP类系统。这类一致性模型包括线性一致性和顺序一致性。
- **Sticky Available** 表示，满足这类一致性模型的系统可以容忍一部分节点发生故障，还未出现故障的节点仍然可用，但前提是客户端不能将请求发送到不可用的副本节点。这类一致性模型包括因果一致性、PRAM 一致性和读你所写一致性。
- **Total Available** 表示，满足这类一致性模型的系统可用性是最高的，即使网络发生严重分区，在没有发生故障的节点上，仍然保证可用。这类一致性模型包括读后写一致性、单调读一致性和单调写一致性。

另外，一致性模型中的一致性强度从上到下越来越弱。箭头还表示包含关系，例如满足线性一致性必然也满足顺序一致性。





## 一致性的种类

- 强一致性：当一个数据被更新后，其他副本中的数据也会实时更新，确保所有副本的数据都是最新的。这种一致性可以保证系统的可靠性和实时性，但实现起来比较复杂。
  弱一致性：当一个数据被更新后，其他副本中的数据可能会延迟更新，但最终会达到一致的状态。这种一致性可以保证系统的可用性和可靠性，但在某些情况下可能会出现数据不一致的情况。





## 三、细节补充

### 线性一致性和顺序一致性







## 参考资料

