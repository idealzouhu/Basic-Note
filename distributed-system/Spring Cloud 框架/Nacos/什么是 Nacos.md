### 什么是 Nacos







### 负载均衡策略

Nacos 在进行服务发现时进行负载均衡。相关策略有：

- **权重随机策略**：Nacos 内置了一种基于权重的负载均衡策略，当服务实例注册到 Nacos 时，可以为每个实例分配权重。负载均衡时，Nacos 会根据这些权重随机选择实例。

- **延迟感知策略**：Nacos 也可以根据实例的健康状况和响应时间选择最优实例进行路由，防止选择到故障实例或负载过高的实例。

**Ribbon** 是 Spring Cloud Netflix 的一个客户端负载均衡器，它允许服务调用者通过各种负载均衡算法（如轮询、随机、加权等）来选择服务实例。

Nacos 负责注册服务和发现服务，而 Ribbon 负责在客户端选择服务实例并进行负载均衡。两者的工作流程是：

1. **服务发现**：客户端通过 Nacos 获取服务的可用实例列表。
2. **负载均衡**：获取到服务实例列表后，Ribbon 会根据配置的负载均衡策略（如轮询或随机）选择一个实例进行调用。





### 就近访问

Nacos 支持通过服务实例的**元数据**来配置并实现就近访问。元数据（metadata）通常会包含实例的区域（zone）、机房（IDC）、**集群**等信息。在服务发现过程中，Nacos 可以根据这些元数据信息，优先选择与客户端处于相同区域或机房的服务实例。





### Nacos 保证的是 CP 还是 AP

注册中心能保证 AP（默认保证） 或者 CP。

配置中心的数据只存储在单个 mysql 节点中，没有 CP 或者 AP 的划分



### 注册中心 CP 好还是 AP 好

AP 更好。

CP 的话，服务上下线压力较大

AP 的话，就算集群节点之间数据出现了不一致，对于业务应用而言，可能拉取到了一个已经下线了的服务节点，但是现在一般的微服务框架或组件都提供了服务容错和重试功能，





### 如何理解命名空间

**命名空间（Namespace）** 是一种用于**逻辑隔离服务和配置**的机制。它允许用户将不同的服务和配置进行分组和隔离，从而实现更加灵活的多租户管理、环境划分等功能。

在Nacos中，不管是配置还是服务，都是属于某一个命名空间中的，默认情况下都是属于pulibc这个命名空间中的，我们可以在Nacos中新增命名空间，也就相当于开辟了另外一套存放服务和配置的地方，命名空间之间是独立的，完全不冲突的。

例如，我们可以为每个环境创建不同的命名空间：

- **dev**：开发环境的命名空间

- **test**：测试环境的命名空间

- **prod**：生产环境的命名空间